<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0"
  xml:lang="ja-JP"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:creativeCommons="http://backend.userland.com/creativeCommonsRssModule"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Weblog - Hail2u.net</title>
    <link>http://hail2u.net/blog/</link>
    <description>ウェブ制作やウェブ標準の話題が中心ですが、それに限らず備忘録や日々の記録までを含めることで、10年以上続けることができたウェブログです。Blosxomを使って作られています。</description>
    <language>ja-JP</language>
    <copyright>Copyright &#x00a9; 2002-2014, Kyo Nagashima</copyright>
    <managingEditor>hail2u@gmail.com (Kyo Nagashima)</managingEditor>
    <webMaster>hail2u@gmail.com (Kyo Nagashima)</webMaster>
    <lastBuildDate>Sun, 28 Dec 2014 04:57:57 +0900</lastBuildDate>
    <generator>blosxom v2.1.2+dev</generator>
    <atom:link rel="self" href="http://hail2u.net/blog/feed"/>
    <atom:link rel="hub" href="https://pubsubhubbub.appspot.com/"/>
    <creativeCommons:license>http://creativecommons.org/licenses/by-nc/3.0/</creativeCommons:license>


    <item>
      <title>“マークアップ”</title>
      <link>http://hail2u.net/blog/webdesign/mark-things-up.html</link>
      <description>クリスマスにTwitterで@glatyouと少しマークアップについてやりとりをした。そこではTwitterなのでだいぶ端折ったものの、だいたい伝わったとは思う。あわせて今年はHTML5勧告のタイミングだ。このようなマークアップについての考え方を述べるにはもってこいだろう。そこで僕の考えを文書としてまとめ、“マークアップ”するということ ～ HTML5勧告に寄せて ～というタイトルで公開した。この文書を持って今年のまとめとしたい。</description>
      <author>hail2u@gmail.com (Kyo Nagashima)</author>
      <category>Web Design</category>
      <guid isPermaLink="true">http://hail2u.net/blog/webdesign/mark-things-up.html</guid>
      <pubDate>Sun, 28 Dec 2014 04:57:00 +0900</pubDate>
      <content:encoded><![CDATA[
<p>クリスマスにTwitterで<a href="https://twitter.com/glatyou">@glatyou</a>と少しマークアップについてやりとりをした。そこではTwitterなのでだいぶ端折ったものの、だいたい伝わったとは思う。あわせて今年はHTML5勧告のタイミングだ。このようなマークアップについての考え方を述べるにはもってこいだろう。そこで僕の考えを文書としてまとめ、<a href="http://hail2u.net/documents/markup.html">“マークアップ”するということ ～ HTML5勧告に寄せて ～</a>というタイトルで公開した。この文書を持って今年のまとめとしたい。</p>

<p>当該文書では、著作権表示という日本ではおよそ実践的でないものを例としたので、多少哲学的な側面が強い。他に良い例がうまく思いつかなかったのもあるし、元々のTwitterでのやりとりがそれだったのもある。他に例を考えるとするとトップニモドルのマークアップでも良かったかもしれない。</p>

<pre><code>&lt;footer&gt;
  &lt;nav&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#logo&quot;&gt;Back to Top&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/nav&gt;
&lt;/footer&gt;
</code></pre>

<p>このような間違いと冗長さが多分に含まれるが、ちょくちょく見かけるようなコードを起点にできる。</p>

<pre><code>&lt;footer&gt;&lt;a href=&quot;#top&quot;&gt;Back to Top&lt;/a&gt;&lt;/footer&gt;
</code></pre>

<p>そしてこう磨き上げるまでを書くのも悪くなかったかもしれない。思考の過程としてはほとんど同じなので、どうしてこうなるのかを考えてみるのも良いだろう。</p>

<p>本当は最後の項でテキトーに書かれたHTML文書が失ったものについてじっくりと書ければもっと完成度の高い文書になったことと思う。しかしそこまで書くとトピックが二分してしまいそうなことと、またその話かで終わってしまいそうな気がしたので、直接的な言葉すらも避けてぼかしておいた。アとかユとかUとかで始まる単語を想像してくれれば遠くないだろう。</p>

<p>このようなマークアップするための思考の元、<a href="https://github.com/hail2u/html-best-practices">HTML Best Practices</a>も参照するとわかりやすいはずだ。出す順が逆だともっと良かったような気がする。</p>

<hr>

<p>ここで予防線をいっぱい張っておきたいところだけれども、それはやめておく。もちろん僕は仕様側の人間ではないので、とか、あくまでも、とか、一般的には、とかいっぱい書きたい。</p>

<p>あ、<a href="http://www.w3.org/2014/10/html5-rec.html.ja">HTML5勧告</a>おめでとうございます。</p>]]></content:encoded>
    </item>

    <item>
      <title>ブラウザー・キャッシュの今</title>
      <link>http://hail2u.net/blog/webdesign/the-browser-cache-today.html</link>
      <description>元々「静的なファイルは限界までキャッシュしろ！」というような金言はそれほど重要視していなかった。The changing role of the browser cacheという記事では、開きっぱなしにされるタブと継続的デプロイをキーワードに、ブラウザー・キャッシュの役割が変化していることを解説している。</description>
      <author>hail2u@gmail.com (Kyo Nagashima)</author>
      <category>Web Design</category>
      <guid isPermaLink="true">http://hail2u.net/blog/webdesign/the-browser-cache-today.html</guid>
      <pubDate>Sat, 27 Dec 2014 00:47:00 +0900</pubDate>
      <content:encoded><![CDATA[
<p>元々「静的なファイルは限界までキャッシュしろ！」というような金言はそれほど重要視していなかった。<a href="http://calendar.perfplanet.com/2014/the-changing-role-of-the-browser-cache/">The changing role of the browser cache</a>という記事では、開きっぱなしにされるタブと継続的デプロイをキーワードに、ブラウザー・キャッシュの役割が変化していることを解説している。</p>

<p>ブラウザー・キャッシュが再訪問に対して威力を発揮するのに対し、開きっぱなしにされるタブでは再訪問されることはなく、継続的デプロイされるアプリケーションではその効果は限定的なものにしかなりえない、という意見だ。納得の出来る意見ではある。</p>

<p>僕が元々こういった長期間のキャッシュに疑問を持っていたのも少し似ている。特に継続的デプロイの元では限定的な効果になることは自明だと考えていた。またいわゆる普通のウェブページにおいては再訪問という行為そのものが随分前から死滅したとも考えている。具体的にはソーシャル・ブックマークの普及後、一時的な消費に偏るようになってからそうなったと思っている。</p>

<p>一方で長期化のデメリットは迅速にキャッシュの更新が行き渡らないという点で明白だ。もちろんキャッシュをリフレッシュする、というか別に配信するテクニックがあり、それを採用するわけだけど、なんというか美しくない。デプロイされる間隔に対して適切なキャッシュ期限を試行錯誤する方が真っ当なんじゃないかという思いが強い。</p>

<p>ウェブのコンポーネント化が進むであろう今後は更に迅速なキャッシュの更新が求められるわけで、ブラウザー・キャッシュの長期化は忌避されていくようになるのかもしれない。</p>

<hr>

<p>今年から読み始めた<a href="http://calendar.perfplanet.com/">Performance Calendar</a>は過去ログもそれなりに面白そうなので、年末年始に読んでみようと思う。</p>]]></content:encoded>
    </item>

    <item>
      <title>スクロールバーの幅</title>
      <link>http://hail2u.net/blog/webdesign/scrollbar-width.html</link>
      <description>スクロールバーの幅を知りたいことはままある。CSSで拾えれば最高なのだけど……というところで、calc(100vw - 100%)で拾えることがわかった。ただこれで拾えるかどうかはその要素の親に依存するので、いつでもどこでも使えるわけではない。せめてJavaScriptでは扱えるようにしてみたい。</description>
      <author>hail2u@gmail.com (Kyo Nagashima)</author>
      <category>Web Design</category>
      <guid isPermaLink="true">http://hail2u.net/blog/webdesign/scrollbar-width.html</guid>
      <pubDate>Fri, 26 Dec 2014 04:24:00 +0900</pubDate>
      <content:encoded><![CDATA[
<p>スクロールバーの幅を知りたいことはままある。CSSで拾えれば最高なのだけど……というところで、<code>calc(100vw - 100%)</code>で拾えることがわかった。ただこれで拾えるかどうかはその要素の親に依存するので、いつでもどこでも使えるわけではない。せめてJavaScriptでは扱えるようにしてみたい。</p>

<p>View Demo: <a href="http://hail2u.net/pub/test/604.html">Get Scrollbar Width with JavaScript</a></p>

<p>ボタンをクリックするとスクロールバーの幅がダイアログで表示される。オーバーレイのスクロールバーの場合は<code>0px</code>になり、そうでない場合はスクロールバーの幅が返る。<code>body</code>要素の幅が<code>100%</code>であることが条件になるが、まず大丈夫だろう。</p>

<p>仕組みは単純なもので<code>width</code>プロパティーを<code>calc(100vw - 100%)</code>にした要素を<code>body</code>要素の子に突っ込んで、計算済みスタイルを拾うというだけだ。<code>overflow</code>プロパティーを切り替え要素の幅を比べる古くからあるものと比べるとコードはわかりやすく短い。その半面、<code>vw</code>単位と<code>calc()</code>関数への対応が必要と敷居は少し高い。</p>

<hr>

<p>そのうち全てオーバーレイ・スクロールバーになりそうではあるので、その暁には無駄な知識になる。是非なってほしい。</p>]]></content:encoded>
    </item>

    <item>
      <title>kyonagashima.com</title>
      <link>http://hail2u.net/blog/internet/kyonagashima-com.html</link>
      <description>Brad Frostが自分の名前のドメインを確保するのにぼったくられたという記事を読んで、良い機会なのでkyonagashima.comを確保した。面倒だったので735円だしといつも通りValue Domainで取得した。</description>
      <author>hail2u@gmail.com (Kyo Nagashima)</author>
      <category>Internet</category>
      <guid isPermaLink="true">http://hail2u.net/blog/internet/kyonagashima-com.html</guid>
      <pubDate>Thu, 25 Dec 2014 03:32:00 +0900</pubDate>
      <content:encoded><![CDATA[
<figure>
  <a href="https://kyonagashima.com/"><img alt="Kyo Nagashima" src="http://hail2u.net/images/blog/kyonagashima-com.gif"></a>
</figure>

<p><a href="http://bradfrost.com/blog/post/bradfrost-dot-com/">Brad Frostが自分の名前のドメインを確保するのにぼったくられたという記事</a>を読んで、良い機会なので<a href="https://kyonagashima.com/">kyonagashima.com</a>を確保した。面倒だったので735円だしといつも通り<a href="https://www.value-domain.com/">Value Domain</a>で取得した。</p>

<p>世間のドメイン取得代行業者への評価は地に落ちているような印象だが、僕は実際に辛いトラブルにあったことがなく、大体は根気強いメールのやりとりのみで解決できてきたので、あまり悪く評価してはいない。でも検索クエリーを横取りして先に奪ってしまうといったことはやってそうだなという程度には信用していない。</p>

<p>実際にそういった状況に遭遇したとしたら、金の問題よりもイライラで沸騰しそうだ。買って後悔することはまずないので、買っておくかという程度の気持ちで確保した。そのはずなのに既に後悔していたりもし、ままならない。とりあえずのところは不要であるのに、ネガティブな理由で動いてしまったからだと思う。</p>

<p>とにかくそういうイライラが待つ未来からとりあえずは解放された。失効させると輪をかけて辛い未来が待っているわけでもあるけれども。あとはむしゃくしゃして消さないようにも気をつけよう。</p>

<hr>

<p>ウェブページは<a href="https://pages.github.com/">GitHub Pages</a> + <a href="https://www.cloudflare.com/">CloudFlare</a>を利用したサブドメインなしのhttpsでの提供にした。httpsの強制(httpへのアクセスをhttpsへリダイレクトさせる)もCloudFlareのPage Ruleを使うと簡単に実現できる。</p>

<figure>
  <img alt="Page Ruleのダッシュボードで、ワイルドカードを使ってURLパターンを指定し、Always use httpsを有効にしたPage Ruleのパターンを追加しようとしているところ" src="http://hail2u.net/images/blog/cloudflare-forcing-https-page-rule.png">

  <figcaption>CloudFlare Page Rule Dashboard</figcaption>
</figure>

<p>内容としてはペライチでソーシャル・ネットワークのプロフィールへのリンク以外には特に何もなく、他に何か使う予定は少ししかない。書き物は今まで通りここに書く。</p>]]></content:encoded>
    </item>

    <item>
      <title>URLUtils.hash (location.hash)とその返す値</title>
      <link>http://hail2u.net/blog/webdesign/urlutils-hash-and-its-returning-value.html</link>
      <description>URLUtilsインターフェイスのブラウザーにおける実装であるLocationオブジェクトのhashプロパティーによりURLのフラグメント識別子(と#)を取得・代入できる。最近のブラウザーは非ASCII文字列もURLエンコードせずに扱えるようになっているが、この辺りの挙動がFirefoxだけ少し違うようだ。それはhashプロパティーの返す値で、常にデコードされた形で返ってくるようになっている。</description>
      <author>hail2u@gmail.com (Kyo Nagashima)</author>
      <category>Web Design</category>
      <guid isPermaLink="true">http://hail2u.net/blog/webdesign/urlutils-hash-and-its-returning-value.html</guid>
      <pubDate>Wed, 24 Dec 2014 01:05:00 +0900</pubDate>
      <content:encoded><![CDATA[
<p><code>URLUtils</code>インターフェイスのブラウザーにおける実装である<code>Location</code>オブジェクトの<code>hash</code>プロパティーによりURLのフラグメント識別子(と<code>#</code>)を取得・代入できる。最近のブラウザーは非ASCII文字列もURLエンコードせずに扱えるようになっているが、この辺りの挙動がFirefoxだけ少し違うようだ。それは<code>hash</code>プロパティーの返す値で、常にデコードされた形で返ってくるようになっている。</p>

<p>例えば適当なウェブページで開発者ツール(的なもの)を開き、コンソール(などと呼ばれてるもの)で以下を実行してみる。</p>

<pre><samp>&gt; <kbd>location.hash = &#39;#&#39; + &#39;あいうえお&#39;</kbd>
&lt; &quot;#あいうえお&quot;
&gt; <kbd>location.hash</kbd>
&lt; &quot;#あいうえお&quot;
&gt; <kbd>location.hash = &#39;#&#39; + encodeURIComponent(&#39;あいうえお&#39;)</kbd>
&lt; &quot;#%E3%81%82%E3%81%84%E3%81%86%E3%81%88%E3%81%8A&quot;
&gt; <kbd>location.hash</kbd>
&lt; &quot;#%E3%81%82%E3%81%84%E3%81%86%E3%81%88%E3%81%8A&quot;
</samp></pre>

<p>Chrome 39やInternet Explorer 11ではこのようになる。<code>location.hash</code>に代入した文字列はそのまま返ってくるだけだ。対してFirefox 34ではURLエンコードした文字列を代入した場合、デコードされて返ってくる。</p>

<pre><samp>&gt; <kbd>location.hash = &#39;#&#39; + &#39;あいうえお&#39;</kbd>
&lt; &quot;#あいうえお&quot;
&gt; <kbd>location.hash</kbd>
&lt; &quot;#あいうえお&quot;
&gt; <kbd>location.hash = &#39;#&#39; + encodeURIComponent(&#39;あいうえお&#39;)</kbd>
&lt; &quot;#%E3%81%82%E3%81%84%E3%81%86%E3%81%88%E3%81%8A&quot;
&gt; <kbd>location.hash</kbd>
&lt; &quot;#あいうえお&quot;
</samp></pre>

<p>もちろん開発者ツール上だけでなく通常のスクリプト上でも同じなので、この辺りを扱う場合はそれなりの注意が必要になる。常にURLエンコードされているのかどうかを意識するべきということだ。</p>

<p>例えば今のGitHubではこの辺りを使って<code>id</code>属性の重複避けと<code>hashchange</code>イベントの監視によるページ内ジャンプを実装している。しかし、URLエンコード済み(<code>href</code>属性の値)とそうでないもの(<code>id</code>属性の値)が混ざっているため、日本語の見出しではChrome 39やInternet Explorer 11だと比較に失敗してページ内ジャンプがうまく動かない。</p>

<hr>

<p>どちらかというとFirefoxの挙動の方が開発者に優しいとは言えるかもしれない。常にデコードされていると想定できるので、二重にエンコードしてしまうことやデコードし忘れということがない。しかしその一方でURLエンコードされた文字列とそうでない文字列が含まれたフラグメント識別子を元に戻すことができないという欠陥もある。<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=483304">Bug 483304</a>でかなり昔から議論されているようだ。</p>

<p><a href="https://url.spec.whatwg.org/">URL仕様</a>では、とにかくフラグメント識別子は<a href="https://url.spec.whatwg.org/#fragment-state">必要ならURLエンコードされているべき</a>となっている。そして<a href="https://url.spec.whatwg.org/#dom-urlutils-hash"><code>URLUtils</code>インターフェイスの<code>hash</code>プロパティー</a>でもゲッターは<code>#</code>と連結して返せというだけになっているので、勝手にデコードして返すのはバグと言って良さそう。</p>]]></content:encoded>
    </item>

    <item>
      <title>:target擬似クラスとHistory API</title>
      <link>http://hail2u.net/blog/webdesign/target-pseudo-class-and-history-api.html</link>
      <description>:target擬似クラスではフラグメント識別子と一致する要素に対してスタイルを当てることができる。これを利用するとCSSだけでインタラクティブにデザインを変更することが可能になる。一方History APIではページの遷移なくフラグメント識別子を含め、アクセス中のURLを書き換えることができる。では:target擬似クラスで有効になっているスタイルは、History APIでフラグメント識別子を変更した場合に動的に切り替わってくれるだろうか。</description>
      <author>hail2u@gmail.com (Kyo Nagashima)</author>
      <category>Web Design</category>
      <guid isPermaLink="true">http://hail2u.net/blog/webdesign/target-pseudo-class-and-history-api.html</guid>
      <pubDate>Tue, 23 Dec 2014 15:20:00 +0900</pubDate>
      <content:encoded><![CDATA[
<p><code>:target</code>擬似クラスではフラグメント識別子と一致する要素に対してスタイルを当てることができる。これを利用するとCSSだけでインタラクティブにデザインを変更することが可能になる。一方History APIではページの遷移なくフラグメント識別子を含め、アクセス中のURLを書き換えることができる。では<code>:target</code>擬似クラスで有効になっているスタイルは、History APIでフラグメント識別子を変更した場合に動的に切り替わってくれるだろうか。</p>

<p>View Demo: <a href="http://hail2u.net/pub/test/603.html">:target and history.replaceState()</a></p>

<p>デモ・ページではEnable #test:targetをクリックするとURLに<code>#test</code>というフラグメント識別子が追加される。<code>#test:target</code>セレクターを通して、文字色を緑にするようにしてあるので、クリック後文章が緑になることだろう。Disable #test:target by history.replaceState()ボタンを押すと<code>history.replaceState()</code>を使ってURLからフラグメント識別子が削られる。ここで文字色が緑から黒になればCSSにも反映されることになる。</p>

<p>しかし、だいたいのブラウザーで緑のままなので、<code>history.replaceState()</code>によるフラグメント識別子の変更に<code>:target</code>擬似クラスは応じてくれないようだ。もしかするとどこかでこういう挙動になるべきと決まっているのかもしれないが、残念ながら僕には見つけられなかった。</p>

<hr>

<p><code>:target</code>擬似クラスを使ったオーバーレイのフルスクリーン・ナビゲーションを作ろうかなという過程で、CSSだけだと消せないためどうしてやろうかと考えていて、History APIを使ってみたらダメだった、という過程で発見した。「珍」というほどではないが、直感的な動作とは思えないので<a href="http://www.adventar.org/calendars/341">CSS珍百景 Advent Calendar 2014</a>の19日目として提供しておく。</p>

<p>対策はそれほど難しくはない。<code>location.hash = &#39;&#39;</code>でフラグメント識別子を空にし、<code>:target</code>擬似クラスを無効にした後、改めて<code>history.replaceState(&#39;&#39;, &#39;&#39;, location.pathname)</code>とすれば良い。</p>]]></content:encoded>
    </item>

    <item>
      <title>mdtoc - The markdown ToC generator</title>
      <link>http://hail2u.net/blog/coding/mdtoc.html</link>
      <description>Markdownファイルの見出しからGitHub互換のToCを生成して埋め込むCLIツール、mdtocを作成した。Node.js製でmarkedパッケージに依存している。実行すると引数に指定したMarkdownファイルの中に書かれた&lt;!-- #toc --&gt;と&lt;!-- /toc --&gt;の間がToCになる。</description>
      <author>hail2u@gmail.com (Kyo Nagashima)</author>
      <category>Coding</category>
      <guid isPermaLink="true">http://hail2u.net/blog/coding/mdtoc.html</guid>
      <pubDate>Mon, 22 Dec 2014 00:40:00 +0900</pubDate>
      <content:encoded><![CDATA[
<p>Markdownファイルの見出しからGitHub互換のToCを生成して埋め込むCLIツール、mdtocを作成した。Node.js製で<a href="https://www.npmjs.com/package/marked">markedパッケージ</a>に依存している。実行すると引数に指定したMarkdownファイルの中に書かれた<code>&lt;!-- #toc --&gt;</code>と<code>&lt;!-- /toc --&gt;</code>の間がToCになる。</p>

<p>Download: <a href="http://hail2u.net/pub/mdtoc.js">mdtoc.js</a></p>

<p>例えば以下のようにMarkdownファイル、<code>foo.md</code>に<code>&lt;!-- #toc --&gt;</code>と<code>&lt;!-- /toc --&gt;</code>を書いておき、</p>

<pre><code>Test
====

&lt;!-- #toc --&gt;
&lt;!-- /toc --&gt;

Foo
---

### Foo Foo

### Foo Bar

Bar
---

### Bar Foo
</code></pre>

<p>ターミナルからmdtocを実行すると、</p>

<pre><samp>$ <kbd>mdtoc foo.md</kbd>
</samp></pre>

<p>以下のようにToCが挿入される。</p>

<pre><code>Test
====

&lt;!-- #toc --&gt;

* [Foo](#foo)
  * [Foo Foo](#foo-foo)
  * [Foo Bar](#foo-bar)
* [Bar](#bar)
  * [Bar Foo](#bar-foo)

&lt;!-- /toc --&gt;

Foo
---

### Foo Foo

### Foo Bar

Bar
---

### Bar Foo
</code></pre>

<p>ToCの生成対象は最初の見出し以外のすべて。インデントは二番目の見出しを基準に調節されるようにした。大抵は<code>README.md</code>に対して使われると思うので、引数を省略した場合は<code>README.md</code>に対して実行するようにもなっている。改行コードは元の文書に従うようにしておいた。</p>

<p>互換性はそこそこありそうだが、Redcarpetを使ったCLIツールの方が確実と思われるので、それを探すか暇な時に書き直したい。そのためnpmで公開するつもりは今のところない。</p>

<hr>

<p><a href="https://github.com/hail2u/html-best-practices">HTML Best Practices</a>のToCを簡単に更新できるようにするために色々探したけど良い物が見つからなかった。</p>

<p><a href="https://www.npmjs.com/package/marked-toc">marked-toc</a>は記号の扱いにGitHubと互換性がなく、大体はうまくいくのだけど、たまにうまくいかない。別の名前で一から作り直してるみたいだが、今度はまったく英数字以外がまったく考慮されないものになっていて期待できない。</p>

<p><a href="https://www.npmjs.com/package/doctoc">doctoc</a>はコード・ブロックに書いた<code>&lt;h1&gt;</code>タグなどを拾ってしまってめちゃくちゃなToCが生成された。他、どうでも良さそうなPRリンクや派手すぎる埋め込みコメントなど色々うっとうしかった。</p>

<p>他にもたくさんあった(npmだけで15くらい見つかる)が、<code>#</code>での見出し限定のものであったり、特殊な記法で見出しを書かなくてはならなかったりと、試すまでもなく使いたくならないものばかりだった。</p>

<p>mdtocでは、markedの<a href="https://github.com/chjj/marked#overriding-renderer-methods">レンダラーの差し替え</a>を利用して見出しをすべて拾い、Redcarpetのコードにあった<a href="https://github.com/vmg/redcarpet/blob/816e0933a120b66759a71284a24eacac8880f765/ext/redcarpet/html.h#L76">削除する文字</a>を削除し、空白をマイナスに置換し、最後にURLエンコードするというだけにした。余計なことをなるべくしないようにしたので、そこそこ互換性があるんじゃないかと思う。</p>

<h2>追記</h2>

<p>Git Repository: <a href="https://github.com/hail2u/node-gfmtoc">node-gfmtoc</a></p>

<p>リポジトリーを作成し、<code>git clone</code>からの<code>npm install &amp;&amp; npm link</code>でサクッと利用可能になるようにしておいた。MarkdownというかGitHub flavored Markdown (正確にはHTML pipeline？)に依存するものなのでgfmtocに名前は変えた。npmレジストリーへ公開はしない。</p>]]></content:encoded>
    </item>

    <item>
      <title>HTML Best Practices</title>
      <link>http://hail2u.net/blog/webdesign/html-best-practices.html</link>
      <description>少し前に書いた失われたウェブ制作のベスト・プラクティスという記事の公開後、やはりある程度まとまった形の文書が必要なのではないかという気分になった。そこでHTMLはどのようなことに気を付けて書くと安定したものになるのかという視点で、悪い例と良い例を併記したHTML Best Practicesという文書を作成した。</description>
      <author>hail2u@gmail.com (Kyo Nagashima)</author>
      <category>Web Design</category>
      <guid isPermaLink="true">http://hail2u.net/blog/webdesign/html-best-practices.html</guid>
      <pubDate>Sun, 21 Dec 2014 00:05:00 +0900</pubDate>
      <content:encoded><![CDATA[
<figure>
  <a href="https://github.com/hail2u/html-best-practices"><img alt="HTML Best Practices" src="http://hail2u.net/images/blog/html-best-practices.png"></a>
</figure>

<p>少し前に書いた<a href="http://hail2u.net/blog/webdesign/lost-best-practices.html">失われたウェブ制作のベスト・プラクティス</a>という記事の公開後、やはりある程度まとまった形の文書が必要なのではないかという気分になった。そこでHTMLはどのようなことに気を付けて書くと安定したものになるのかという視点で、悪い例と良い例を併記した<a href="https://github.com/hail2u/html-best-practices">HTML Best Practices</a>という文書を作成した。</p>

<p>それぞれにそれぞれの理由はあるが、その解説は簡単ではない。歴史的な背景を始めとした様々な点からの落とし所であり、それら前提となる物事について書くとなると膨大な量になりうる。そのためコード例で悪いものと良いものを併記するだけに留めておいた。</p>

<p>こうなっていると、「なぜ」がわからないという面もあるが、「これをこう書けるのか」というような面もある。啓蒙的な意味合いが強い文書にも関わらずカジュアルに読めるため、悪くはないのではないかと思う。</p>

<hr>

<p>現時点でほとんどの要素の書き方についてはひと通り触れることができた。多くは僕の知識に基づくものなので、それなりに「今」を反映できているはずだ。他も仕様のコード例をアレンジしたもののため、正しく、シンプルなものにできていることと思う。</p>

<p>このような安定性を意識した書き方に沿って、シンプルにHTMLを書いていけば、保守しやすく拡張しやすいウェブサイトを制作できることだろう。</p>

<hr>

<p>しかし、この文書にはこういったベスト・プラクティスと呼ばれるものに欠かすことのできない系統のものがまったく出てこない。それはパフォーマンスについてのベスト・プラクティスだ。</p>

<p>パフォーマンス向上を目指したHTMLの書き方とは、つまりHTTPリクエストが効率的に行われるような書き方だ。例えば<code>script</code>要素を動的に追加することによる非同期なJavaScriptの実行が挙げられる。しかしこれには<a href="https://www.igvita.com/2014/05/20/script-injected-async-scripts-considered-harmful/">有害だという大家からの意見</a>が既にある。またCSSをJavaScriptより先に読み込むというセオリーも崩れ始めている(<a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Optimizing_your_pages_for_speculative_parsing">speculative parsing (投機的パース)</a>による)。そしてHTTP/2も控えている。</p>

<p>こういったHTTPリクエストの効率化を目指すための書き方は、数年前ならともかく、激変しつつある今は刹那的なテクニックにしか成りえなそうだ。ベスト・プラクティスと呼べるようなものは減りつつあるのではないか。とは言うものの、そのようなテクニックについて追加してくれれば、取り込むことはやぶさかではない。</p>

<p>他、もちろん提案はどんなものでも大歓迎なので、悪い例と良い例を作るくらいで是非気軽に提案して欲しい。例さえあればあとはタイトルを英語で考えるだけなので、日本語で提案してくれてもまったく構わない。既に載せたものに関してもベスト・プラクティスとは思えないというような意見も、むしろこちらをお願いしたい。</p>]]></content:encoded>
    </item>

    <item>
      <title>複数のPNGからICOへ変換</title>
      <link>http://hail2u.net/blog/software/convert-pngs-into-ico.html</link>
      <description>favicon.icoの作成を自動化しようとして、いくつかCLIの変換ツールを物色していた。最終的にImageMagickのconvertに行き着いたので、あまり得られるところはなかった……。</description>
      <author>hail2u@gmail.com (Kyo Nagashima)</author>
      <category>Software</category>
      <guid isPermaLink="true">http://hail2u.net/blog/software/convert-pngs-into-ico.html</guid>
      <pubDate>Sat, 20 Dec 2014 05:03:00 +0900</pubDate>
      <content:encoded><![CDATA[
<p>favicon.icoの作成を自動化しようとして、いくつかCLIの変換ツールを物色していた。最終的に<a href="http://www.imagemagick.org/">ImageMagick</a>のconvertに行き着いたので、あまり得られるところはなかった……。</p>

<h2><a href="http://www.winterdrache.de/freeware/png2ico/">png2ico</a></h2>

<pre><samp>$ <kbd>png2ico favicon.ico logo-16.png logo-32.png logo-48.png logo-256.png</kbd>
</samp></pre>

<p>特に何も考えずに使える良いツールだった。しかし256x256以上、つまり256x256のアイコンは含めることができない制限がある。16x16以外に32x32だけでなく、256x256を含めてやりたい現状だとちょっと使いづらい気がする。</p>

<h2><a href="http://wizard.ae.krakow.pl/~jb/toico/">ToICO</a></h2>

<pre><samp>$ <kbd>toico -o favicon.ico logo-16.png logo-32.png logo-48.png logo-256.png</kbd>
</samp></pre>

<p>これもあまり考えずに使えた。しかし生成されるICOファイルが異様に大きい。256x256を含めたところ70KBを超えるサイズになってしまった。高解像度を含めるとはいえ、せめて20KB、できれば10KB以下にはしたいので、このサイズはちょっと厳しい。</p>

<h2>ImageMagickのconvert</h2>

<pre><samp>$ <kbd>convert logo-16.png logo-32.png logo-48.png logo-256.png favicon.ico</kbd>
</samp></pre>

<p>樹海のようにコマンドライン・オプションが複雑だが、ICOへの変換は単純なものだった。特に問題はなさそうに見える。出力サイズも15KBとまずまずだった。</p>

<hr>

<p>ポータビリティーのことも考えるとやはりImageMagickかという感じだ。パスを通さずにいかにして使うかみたいに頑張るのが一番大変だった。<code>C:\WINDOWS\system32\convert.exe</code>を消しさりたい。</p>]]></content:encoded>
    </item>

    <item>
      <title>Hender Schemeの財布</title>
      <link>http://hail2u.net/blog/gadget/hender-scheme-wallet.html</link>
      <description>どんな財布を買おうか色々悩んだ結果、Hender Schemeのものにした。この財布は同型でシーズンごとに出ていて、これは2015 SSシーズンのブライドルレザーのもの。色で3日悩んだけど、結局黒にした。使いやすいとか機能性が高いとかではないけど、自分の欲しい機能は満たしていることと革の感じが良かったのでこれに決めた。16200円。</description>
      <author>hail2u@gmail.com (Kyo Nagashima)</author>
      <category>Gadget</category>
      <guid isPermaLink="true">http://hail2u.net/blog/gadget/hender-scheme-wallet.html</guid>
      <pubDate>Fri, 19 Dec 2014 12:04:00 +0900</pubDate>
      <content:encoded><![CDATA[
<figure>
  <img alt="袋状小銭いれ(ボタンなし)と同じく袋状のカード収納、札入れがコンパクトにまとまっているHender Schemeの財布" src="http://hail2u.net/images/blog/hender-scheme-wallet.jpg">
</figure>

<p>どんな財布を買おうか色々悩んだ結果、<a href="http://henderscheme.com/">Hender Scheme</a>のものにした。この財布は同型でシーズンごとに出ていて、これは2015 SSシーズンのブライドルレザーのもの。色で3日悩んだけど、結局黒にした。使いやすいとか機能性が高いとかではないけど、自分の欲しい機能は満たしていることと革の感じが良かったのでこれに決めた。16200円。</p>

<p>ようやく財布(とついでにスマホ)を鞄に入れるのに慣れてきた。まだポケットが空だと心もとないけれど、財布持ってたっけと鞄を確認することはほぼなくなった。でもポケットに入れないと財布の革がうまく馴染んでこないかもなーと思ってたりもする。</p>]]></content:encoded>
    </item>

  </channel>
</rss>
